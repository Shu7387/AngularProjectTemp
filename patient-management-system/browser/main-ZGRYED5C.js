import{A as j,B as X,C as V,a as It,b as U,c as _,d as $,e as Z,f as Ke,g as Ft,h as Ne,i as J,k as Mt,l as At,m as Tt,n as De,o as Re,p as Be,q as K,r as Q,t as Lt,u as kt,v as Ot,w as Vt,x as qe,y as Ge,z as Ue}from"./chunk-CHRXKQJA.js";import{a as Pt,b as ke,c as Oe,d as L,e as Ve,f as wt}from"./chunk-GAJWT646.js";import{f as Y,g as M,h as A,i as bt,j as xt,k as Ct,l as Te,m as yt,n as Le,o as T,u as St,v as Et}from"./chunk-63D4ALCY.js";import{$ as N,$a as g,A as st,Aa as pt,Ba as y,Fa as w,G as O,Ha as Fe,Ia as Me,Ka as u,L as mt,Q as I,Qa as s,Ra as o,Sa as r,Ta as m,V as v,W as f,Wa as ut,Xa as gt,Ya as P,a as et,ab as p,b as tt,da as ct,ea as D,f as H,ha as we,hb as E,ib as vt,jb as S,k as it,ka as Ie,kb as ft,lb as a,mb as x,n as nt,nb as h,ob as z,pb as R,qb as B,ra as Je,rb as q,sb as Ae,ta as l,tb as ht,u as rt,ub as _t,vb as F,w as ot,wb as G,x as at,xb as W,y as lt,yb as ae,z as dt}from"./chunk-ZAWNPOR3.js";var $e=class i{constructor(){console.log("ValidationService instantiated at root level")}ageRangeValidator(n,e){return t=>{if(!t.value)return null;let d=new Date(t.value),c=new Date,b=c.getFullYear()-d.getFullYear(),C=c.getMonth()-d.getMonth();return(C<0||C===0&&c.getDate()<d.getDate())&&b--,b<n||b>e?{ageRange:{min:n,max:e,actual:b}}:null}}bloodGroupValidator(){return n=>n.value?["A+","A-","B+","B-","AB+","AB-","O+","O-"].includes(n.value)?null:{invalidBloodGroup:{value:n.value}}:null}phoneValidator(){return n=>n.value?/^\+?[\d\s\-()]{10,}$/.test(n.value)?null:{invalidPhone:!0}:null}emailExistsValidator(n){return e=>e.value&&n.includes(e.value.toLowerCase())?{emailExists:!0}:null}static \u0275fac=function(e){return new(e||i)};static \u0275prov=mt({token:i,factory:i.\u0275fac,providedIn:"root"})};function $t(i,n){i&1&&(o(0,"div"),a(1," First name is required "),r())}function jt(i,n){i&1&&(o(0,"div"),a(1," Minimum 2 characters required "),r())}function Ht(i,n){if(i&1&&(o(0,"div",53),u(1,$t,2,0,"div",54)(2,jt,2,0,"div",54),r()),i&2){let e,t,d=p();l(),s("ngIf",(e=d.reactiveForm.get("firstName"))==null||e.errors==null?null:e.errors.required),l(),s("ngIf",(t=d.reactiveForm.get("firstName"))==null||t.errors==null?null:t.errors.minlength)}}function Wt(i,n){i&1&&(o(0,"div"),a(1," Last name is required "),r())}function zt(i,n){if(i&1&&(o(0,"div",53),u(1,Wt,2,0,"div",54),r()),i&2){let e,t=p();l(),s("ngIf",(e=t.reactiveForm.get("lastName"))==null||e.errors==null?null:e.errors.required)}}function Yt(i,n){i&1&&(o(0,"div"),a(1," Date of birth is required "),r())}function Zt(i,n){if(i&1&&(o(0,"div",53),u(1,Yt,2,0,"div",54),r()),i&2){let e,t=p();l(),s("ngIf",(e=t.reactiveForm.get("dateOfBirth"))==null||e.errors==null?null:e.errors.required)}}function Jt(i,n){i&1&&(o(0,"div",53),a(1," Gender is required "),r())}function Kt(i,n){i&1&&(o(0,"div"),a(1," Blood group is required "),r())}function Qt(i,n){i&1&&(o(0,"div"),a(1," Invalid blood group (e.g., A+, O-, AB+) "),r())}function Xt(i,n){if(i&1&&(o(0,"div",53),u(1,Kt,2,0,"div",54)(2,Qt,2,0,"div",54),r()),i&2){let e,t,d=p();l(),s("ngIf",(e=d.reactiveForm.get("bloodGroup"))==null||e.errors==null?null:e.errors.required),l(),s("ngIf",(t=d.reactiveForm.get("bloodGroup"))==null||t.errors==null?null:t.errors.invalidBloodGroup)}}function ei(i,n){i&1&&(o(0,"div"),a(1,"Email is required"),r())}function ti(i,n){i&1&&(o(0,"div"),a(1,"Invalid email format"),r())}function ii(i,n){i&1&&(o(0,"div"),a(1," Email already exists "),r())}function ni(i,n){if(i&1&&(o(0,"div",53),u(1,ei,2,0,"div",54)(2,ti,2,0,"div",54)(3,ii,2,0,"div",54),r()),i&2){let e,t,d,c=p();l(),s("ngIf",(e=c.reactiveForm.get("email"))==null||e.errors==null?null:e.errors.required),l(),s("ngIf",(t=c.reactiveForm.get("email"))==null||t.errors==null?null:t.errors.email),l(),s("ngIf",(d=c.reactiveForm.get("email"))==null||d.errors==null?null:d.errors.emailExists)}}function ri(i,n){i&1&&(o(0,"div"),a(1,"Phone is required"),r())}function oi(i,n){i&1&&(o(0,"div"),a(1," Invalid phone format (123-456-7890) "),r())}function ai(i,n){if(i&1&&(o(0,"div",53),u(1,ri,2,0,"div",54)(2,oi,2,0,"div",54),r()),i&2){let e,t,d=p();l(),s("ngIf",(e=d.reactiveForm.get("phone"))==null||e.errors==null?null:e.errors.required),l(),s("ngIf",(t=d.reactiveForm.get("phone"))==null||t.errors==null?null:t.errors.invalidPhone)}}function li(i,n){i&1&&(o(0,"div",53),a(1," Address is required "),r())}function di(i,n){if(i&1){let e=P();o(0,"div",55),m(1,"input",56),o(2,"button",57),g("click",function(){let d=v(e).index,c=p();return f(c.removeAllergy(d))}),m(3,"i",58),r()()}if(i&2){let e=n.index;l(),s("formControlName",e)}}function si(i,n){if(i&1){let e=P();o(0,"div",55),m(1,"input",59),o(2,"button",57),g("click",function(){let d=v(e).index,c=p();return f(c.removeMedication(d))}),m(3,"i",58),r()()}if(i&2){let e=n.index;l(),s("formControlName",e)}}function mi(i,n){i&1&&(o(0,"div",53),a(1," Emergency contact name is required "),r())}function ci(i,n){i&1&&(o(0,"div",53),a(1," Relationship is required "),r())}function pi(i,n){i&1&&(o(0,"div"),a(1," Emergency contact phone is required "),r())}function ui(i,n){i&1&&(o(0,"div"),a(1," Invalid phone format "),r())}function gi(i,n){if(i&1&&(o(0,"div",53),u(1,pi,2,0,"div",54)(2,ui,2,0,"div",54),r()),i&2){let e,t,d=p();l(),s("ngIf",(e=d.reactiveForm.get("emergencyContact.phone"))==null||e.errors==null?null:e.errors.required),l(),s("ngIf",(t=d.reactiveForm.get("emergencyContact.phone"))==null||t.errors==null?null:t.errors.invalidPhone)}}function vi(i,n){i&1&&m(0,"span",60)}function fi(i,n){i&1&&(o(0,"div",61),m(1,"i",62),a(2," Patient added successfully! "),r())}function hi(i,n){if(i&1){let e=P();o(0,"div",63),m(1,"i",64),a(2),o(3,"button",65),g("click",function(){v(e);let d=p();return f(d.submitError=null)}),r()()}if(i&2){let e=p();l(2),h(" ",e.submitError," ")}}var ee=class i{constructor(n,e,t,d){this.fb=n;this.patientService=e;this.validationService=t;this.logger=d;this.logger.log("AddPatient component instantiated")}patientAdded=new N;cancelled=new N;reactiveForm;isSubmitting=D(!1);submitError=null;submitSuccess=!1;destroy$=new H;bloodGroups=["A+","A-","B+","B-","AB+","AB-","O+","O-"];statusOptions=["Active","Inactive","Critical","Discharged"];genderOptions=["Male","Female","Other"];ngOnInit(){this.initializeReactiveForm(),this.setupFormValueChanges(),this.logger.log("AddPatient component initialized")}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.logger.log("AddPatient component destroyed")}initializeReactiveForm(){this.reactiveForm=this.fb.group({firstName:["",[_.required,_.minLength(2),_.maxLength(50)]],lastName:["",[_.required,_.minLength(2),_.maxLength(50)]],email:["",[_.required,_.email]],phone:["",[_.required,this.validationService.phoneValidator()]],dateOfBirth:["",[_.required,this.validationService.ageRangeValidator(0,120)]],gender:["Male",_.required],bloodGroup:["",[_.required,this.validationService.bloodGroupValidator()]],address:["",[_.required,_.minLength(10)]],status:["active",_.required],medicalHistory:[""],allergies:this.fb.array([]),currentMedications:this.fb.array([]),emergencyContact:this.fb.group({name:["",[_.required,_.minLength(2),_.maxLength(50)]],relation:["",[_.required,_.minLength(2),_.maxLength(50)]],phone:["",[_.required,this.validationService.phoneValidator()]]})}),this.logger.log("Reactive form initialized with validators")}setupFormValueChanges(){this.reactiveForm.get("email")?.valueChanges.pipe(O(this.destroy$)).subscribe(n=>{this.logger.log(`Email changed: ${n}`)}),this.reactiveForm.statusChanges.pipe(O(this.destroy$)).subscribe(n=>{this.logger.log(`Form status: ${n}`)})}get allergies(){return this.reactiveForm.get("allergies")}get currentMedications(){return this.reactiveForm.get("currentMedications")}addAllergy(){this.allergies.push(this.fb.control("",_.required)),this.logger.log("Allergy field added")}removeAllergy(n){this.allergies.removeAt(n),this.logger.log(`Allergy field ${n} removed`)}addMedication(){this.currentMedications.push(this.fb.control("",_.required)),this.logger.log("Medication field added")}removeMedication(n){this.currentMedications.removeAt(n),this.logger.log(`Medication field ${n} removed`)}onReactiveSubmit(){if(this.reactiveForm.invalid){this.markFormGroupTouched(this.reactiveForm),this.logger.error("Reactive form is invalid");return}this.isSubmitting.set(!0),this.submitError=null;let n=this.reactiveForm.value,e=n.currentMedications||[],t={firstName:n.firstName,lastName:n.lastName,name:`${n.firstName} ${n.lastName}`,email:n.email,phone:n.phone,dateOfBirth:n.dateOfBirth,gender:n.gender,bloodGroup:n.bloodGroup,address:n.address,status:n.status.charAt(0).toUpperCase()+n.status.slice(1),lastVisit:new Date().toISOString().split("T")[0],admissionDate:new Date().toISOString().split("T")[0],medicalHistory:n.medicalHistory||"No medical history provided",allergies:n.allergies||[],currentMedications:e,currentMedication:e.join(", ")};this.patientService.createPatient(t).pipe(lt(5500),O(this.destroy$),st(()=>this.isSubmitting.set(!1))).subscribe({next:d=>{this.logger.log(`Patient created successfully: ${d.id}`),this.submitSuccess=!0,setTimeout(()=>{this.patientAdded.emit(d),this.resetForms(),this.submitSuccess=!1},5500)},error:d=>{this.submitError=d.message,this.logger.error(`Failed to create patient: ${d.message}`)},complete:()=>{}})}resetForms(){this.reactiveForm.reset({status:"Active",gender:"Male"}),this.allergies.clear(),this.currentMedications.clear(),this.submitSuccess=!1,this.submitError=null}onCancel(){this.cancelled.emit(),this.logger.log("Add patient cancelled")}markFormGroupTouched(n){Object.keys(n.controls).forEach(e=>{let t=n.get(e);t?.markAsTouched(),t instanceof Ke?this.markFormGroupTouched(t):t instanceof Mt&&t.controls.forEach(d=>{d instanceof Ke?this.markFormGroupTouched(d):d.markAsTouched()})})}isFieldInvalid(n){let e=this.reactiveForm.get(n);return!!(e&&e.invalid&&(e.dirty||e.touched))}getErrorMessage(n){let e=this.reactiveForm.get(n);if(!e||!e.errors)return"";let t=e.errors;return t.required?"This field is required":t.email?"Invalid email format":t.minlength?`Minimum length is ${t.minlength.requiredLength}`:t.maxlength?`Maximum length is ${t.maxlength.requiredLength}`:t.invalidPhone?"Invalid phone number format (e.g., +1-555-1234)":t.ageRange?`Age must be between ${t.ageRange.min} and ${t.ageRange.max}`:t.invalidBloodGroup?"Invalid blood group":"Invalid field"}static \u0275fac=function(e){return new(e||i)(y(qe),y(X),y($e),y(j))};static \u0275cmp=w({type:i,selectors:[["app-add-patient"]],outputs:{patientAdded:"patientAdded",cancelled:"cancelled"},features:[Ae([j])],decls:113,vars:41,consts:[[1,"container","mt-4"],[1,"card"],[1,"card-header","bg-primary","text-white"],[1,"mb-0"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"text-secondary","mb-3"],[1,"row","mb-3"],[1,"col-md-6"],["for","firstName",1,"form-label"],["type","text","id","firstName","formControlName","firstName",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","lastName",1,"form-label"],["type","text","id","lastName","formControlName","lastName",1,"form-control"],[1,"col-md-4"],["for","dateOfBirth",1,"form-label"],["type","date","id","dateOfBirth","formControlName","dateOfBirth",1,"form-control"],["for","gender",1,"form-label"],["id","gender","formControlName","gender",1,"form-select"],["value",""],["value","Male"],["value","Female"],["value","Other"],["for","bloodGroup",1,"form-label"],["type","text","id","bloodGroup","formControlName","bloodGroup","placeholder","e.g., A+, O-, AB+",1,"form-control"],[1,"text-secondary","mb-3","mt-4"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email",1,"form-control"],["for","phone",1,"form-label"],["type","tel","id","phone","formControlName","phone","placeholder","(123) 456-7890",1,"form-control"],[1,"mb-3"],["for","address",1,"form-label"],["id","address","formControlName","address","rows","2",1,"form-control"],[1,"form-label","d-flex","justify-content-between","align-items-center"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"bi","bi-plus-circle"],["formArrayName","allergies"],["class","input-group mb-2",4,"ngFor","ngForOf"],[1,"text-muted"],["formArrayName","currentMedications"],["formGroupName","emergencyContact"],["for","emergencyName",1,"form-label"],["type","text","id","emergencyName","formControlName","name",1,"form-control"],["for","emergencyRelation",1,"form-label"],["type","text","id","emergencyRelation","formControlName","relation",1,"form-control"],["for","emergencyPhone",1,"form-label"],["type","tel","id","emergencyPhone","formControlName","phone","placeholder","(123) 456-7890",1,"form-control"],[1,"d-flex","justify-content-end","gap-2","mt-4"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","alert alert-success mt-3",4,"ngIf"],["class","alert alert-danger mt-3 alert-dismissible fade show",4,"ngIf"],[1,"invalid-feedback"],[4,"ngIf"],[1,"input-group","mb-2"],["type","text","placeholder","Enter allergy",1,"form-control",3,"formControlName"],["type","button",1,"btn","btn-outline-danger",3,"click"],[1,"bi","bi-trash"],["type","text","placeholder","Enter medication",1,"form-control",3,"formControlName"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"alert","alert-success","mt-3"],[1,"bi","bi-check-circle-fill","me-2"],[1,"alert","alert-danger","mt-3","alert-dismissible","fade","show"],[1,"bi","bi-exclamation-triangle-fill","me-2"],["type","button","aria-label","Close",1,"btn-close",3,"click"]],template:function(e,t){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),a(4,"Add New Patient (Reactive Form)"),r()(),o(5,"div",4)(6,"form",5),g("ngSubmit",function(){return t.onReactiveSubmit()}),o(7,"h5",6),a(8,"Basic Information"),r(),o(9,"div",7)(10,"div",8)(11,"label",9),a(12,"First Name *"),r(),m(13,"input",10),u(14,Ht,3,2,"div",11),r(),o(15,"div",8)(16,"label",12),a(17,"Last Name *"),r(),m(18,"input",13),u(19,zt,2,1,"div",11),r()(),o(20,"div",7)(21,"div",14)(22,"label",15),a(23,"Date of Birth *"),r(),m(24,"input",16),u(25,Zt,2,1,"div",11),r(),o(26,"div",14)(27,"label",17),a(28,"Gender *"),r(),o(29,"select",18)(30,"option",19),a(31,"Select Gender"),r(),o(32,"option",20),a(33,"Male"),r(),o(34,"option",21),a(35,"Female"),r(),o(36,"option",22),a(37,"Other"),r()(),u(38,Jt,2,0,"div",11),r(),o(39,"div",14)(40,"label",23),a(41,"Blood Group *"),r(),m(42,"input",24),u(43,Xt,3,2,"div",11),r()(),o(44,"h5",25),a(45,"Contact Information"),r(),o(46,"div",7)(47,"div",8)(48,"label",26),a(49,"Email *"),r(),m(50,"input",27),u(51,ni,4,3,"div",11),r(),o(52,"div",8)(53,"label",28),a(54,"Phone *"),r(),m(55,"input",29),u(56,ai,3,2,"div",11),r()(),o(57,"div",30)(58,"label",31),a(59,"Address *"),r(),m(60,"textarea",32),u(61,li,2,0,"div",11),r(),o(62,"h5",25),a(63,"Medical Information"),r(),o(64,"div",30)(65,"label",33)(66,"span"),a(67,"Allergies"),r(),o(68,"button",34),g("click",function(){return t.addAllergy()}),m(69,"i",35),a(70," Add Allergy "),r()(),o(71,"div",36),u(72,di,4,1,"div",37),r(),o(73,"small",38),a(74,"Add any known allergies"),r()(),o(75,"div",30)(76,"label",33)(77,"span"),a(78,"Current Medications"),r(),o(79,"button",34),g("click",function(){return t.addMedication()}),m(80,"i",35),a(81," Add Medication "),r()(),o(82,"div",39),u(83,si,4,1,"div",37),r(),o(84,"small",38),a(85,"Add current medications"),r()(),o(86,"h5",25),a(87,"Emergency Contact"),r(),o(88,"div",40)(89,"div",7)(90,"div",8)(91,"label",41),a(92,"Contact Name *"),r(),m(93,"input",42),u(94,mi,2,0,"div",11),r(),o(95,"div",8)(96,"label",43),a(97,"Relationship *"),r(),m(98,"input",44),u(99,ci,2,0,"div",11),r()(),o(100,"div",30)(101,"label",45),a(102,"Contact Phone *"),r(),m(103,"input",46),u(104,gi,3,2,"div",11),r()(),o(105,"div",47)(106,"button",48),g("click",function(){return t.onCancel()}),a(107,"Cancel"),r(),o(108,"button",49),u(109,vi,1,0,"span",50),a(110),r()()(),u(111,fi,3,0,"div",51)(112,hi,4,1,"div",52),r()()()),e&2){let d,c,b,C,de,se,me,ce,pe,ue,ge,ve,fe,he,_e,be,xe,Ce,ye,Pe,Se,Ee;l(6),s("formGroup",t.reactiveForm),l(7),S("is-invalid",((d=t.reactiveForm.get("firstName"))==null?null:d.invalid)&&((d=t.reactiveForm.get("firstName"))==null?null:d.touched)),l(),s("ngIf",((c=t.reactiveForm.get("firstName"))==null?null:c.invalid)&&((c=t.reactiveForm.get("firstName"))==null?null:c.touched)),l(4),S("is-invalid",((b=t.reactiveForm.get("lastName"))==null?null:b.invalid)&&((b=t.reactiveForm.get("lastName"))==null?null:b.touched)),l(),s("ngIf",((C=t.reactiveForm.get("lastName"))==null?null:C.invalid)&&((C=t.reactiveForm.get("lastName"))==null?null:C.touched)),l(5),S("is-invalid",((de=t.reactiveForm.get("dateOfBirth"))==null?null:de.invalid)&&((de=t.reactiveForm.get("dateOfBirth"))==null?null:de.touched)),l(),s("ngIf",((se=t.reactiveForm.get("dateOfBirth"))==null?null:se.invalid)&&((se=t.reactiveForm.get("dateOfBirth"))==null?null:se.touched)),l(4),S("is-invalid",((me=t.reactiveForm.get("gender"))==null?null:me.invalid)&&((me=t.reactiveForm.get("gender"))==null?null:me.touched)),l(9),s("ngIf",((ce=t.reactiveForm.get("gender"))==null?null:ce.invalid)&&((ce=t.reactiveForm.get("gender"))==null?null:ce.touched)),l(4),S("is-invalid",((pe=t.reactiveForm.get("bloodGroup"))==null?null:pe.invalid)&&((pe=t.reactiveForm.get("bloodGroup"))==null?null:pe.touched)),l(),s("ngIf",((ue=t.reactiveForm.get("bloodGroup"))==null?null:ue.invalid)&&((ue=t.reactiveForm.get("bloodGroup"))==null?null:ue.touched)),l(7),S("is-invalid",((ge=t.reactiveForm.get("email"))==null?null:ge.invalid)&&((ge=t.reactiveForm.get("email"))==null?null:ge.touched)),l(),s("ngIf",((ve=t.reactiveForm.get("email"))==null?null:ve.invalid)&&((ve=t.reactiveForm.get("email"))==null?null:ve.touched)),l(4),S("is-invalid",((fe=t.reactiveForm.get("phone"))==null?null:fe.invalid)&&((fe=t.reactiveForm.get("phone"))==null?null:fe.touched)),l(),s("ngIf",((he=t.reactiveForm.get("phone"))==null?null:he.invalid)&&((he=t.reactiveForm.get("phone"))==null?null:he.touched)),l(4),S("is-invalid",((_e=t.reactiveForm.get("address"))==null?null:_e.invalid)&&((_e=t.reactiveForm.get("address"))==null?null:_e.touched)),l(),s("ngIf",((be=t.reactiveForm.get("address"))==null?null:be.invalid)&&((be=t.reactiveForm.get("address"))==null?null:be.touched)),l(11),s("ngForOf",t.allergies.controls),l(11),s("ngForOf",t.currentMedications.controls),l(10),S("is-invalid",((xe=t.reactiveForm.get("emergencyContact.name"))==null?null:xe.invalid)&&((xe=t.reactiveForm.get("emergencyContact.name"))==null?null:xe.touched)),l(),s("ngIf",((Ce=t.reactiveForm.get("emergencyContact.name"))==null?null:Ce.invalid)&&((Ce=t.reactiveForm.get("emergencyContact.name"))==null?null:Ce.touched)),l(4),S("is-invalid",((ye=t.reactiveForm.get("emergencyContact.relation"))==null?null:ye.invalid)&&((ye=t.reactiveForm.get("emergencyContact.relation"))==null?null:ye.touched)),l(),s("ngIf",((Pe=t.reactiveForm.get("emergencyContact.relation"))==null?null:Pe.invalid)&&((Pe=t.reactiveForm.get("emergencyContact.relation"))==null?null:Pe.touched)),l(4),S("is-invalid",((Se=t.reactiveForm.get("emergencyContact.phone"))==null?null:Se.invalid)&&((Se=t.reactiveForm.get("emergencyContact.phone"))==null?null:Se.touched)),l(),s("ngIf",((Ee=t.reactiveForm.get("emergencyContact.phone"))==null?null:Ee.invalid)&&((Ee=t.reactiveForm.get("emergencyContact.phone"))==null?null:Ee.touched)),l(4),s("disabled",t.reactiveForm.invalid||t.isSubmitting()),l(),s("ngIf",t.isSubmitting()),l(),h(" ",t.isSubmitting()?"Submitting...":"Add Patient"," "),l(),s("ngIf",t.submitSuccess),l(),s("ngIf",t.submitError)}},dependencies:[T,M,A,Ue,J,K,Q,U,Be,$,Z,Re,De,At,Tt],encapsulation:2})};var _i=(i,n)=>({"is-invalid":i,"is-valid":n});function bi(i,n){if(i&1){let e=P();o(0,"div",32),m(1,"i",33),a(2),o(3,"button",34),g("click",function(){v(e);let d=p();return f(d.errorMessage=null)}),r()()}if(i&2){let e=p();l(2),h(" ",e.errorMessage," ")}}function xi(i,n){i&1&&(o(0,"div"),a(1,"Username is required"),r())}function Ci(i,n){i&1&&(o(0,"div"),a(1,"Username must be at least 3 characters"),r())}function yi(i,n){if(i&1&&(o(0,"div",35),u(1,xi,2,0,"div",36)(2,Ci,2,0,"div",36),r()),i&2){let e=p();l(),s("ngIf",e.username==null||e.username.errors==null?null:e.username.errors.required),l(),s("ngIf",e.username==null||e.username.errors==null?null:e.username.errors.minlength)}}function Pi(i,n){i&1&&(o(0,"div"),a(1,"Password is required"),r())}function Si(i,n){i&1&&(o(0,"div"),a(1,"Password must be at least 6 characters"),r())}function Ei(i,n){if(i&1&&(o(0,"div",37),u(1,Pi,2,0,"div",36)(2,Si,2,0,"div",36),r()),i&2){let e=p();l(),s("ngIf",e.password==null||e.password.errors==null?null:e.password.errors.required),l(),s("ngIf",e.password==null||e.password.errors==null?null:e.password.errors.minlength)}}function wi(i,n){i&1&&m(0,"span",38)}function Ii(i,n){i&1&&m(0,"i",39)}function Fi(i,n){if(i&1){let e=P();o(0,"div",40)(1,"div",41)(2,"div",42)(3,"div",43)(4,"div")(5,"small",44)(6,"strong"),a(7),r()(),o(8,"small",5),a(9),r()(),o(10,"button",45),g("click",function(){let d=v(e).$implicit,c=p();return f(c.quickLogin(d.username,d.password))}),m(11,"i",46),a(12," Login "),r()()()()()}if(i&2){let e=n.$implicit,t=p();l(7),x(e.role),l(2),z("",e.username," / ",e.password),l(),s("disabled",t.isLoading)}}var je=class i{route=I(ke);router=I(L);authService=I(V);fb=I(qe);loginForm;isLoading=!1;errorMessage=null;showPassword=!1;returnUrl="";demoCredentials=[{username:"admin",password:"admin123",role:"Administrator"},{username:"doctor",password:"doctor123",role:"Doctor"},{username:"nurse",password:"nurse123",role:"Nurse"}];ngOnInit(){this.loginForm=this.fb.group({username:["",[_.required,_.minLength(3)]],password:["",[_.required,_.minLength(6)]],rememberMe:[!1]});let n=this.route.snapshot.queryParamMap.get("returnUrl");n?this.returnUrl=n:this.route.queryParamMap.pipe(nt(e=>e.get("returnUrl")),at(1)).subscribe(e=>{e&&(this.returnUrl=e)}),this.authService.isLoggedIn()&&this.router.navigateByUrl(this.returnUrl||"/dashboard")}onSubmit(){if(this.loginForm.invalid){this.markFormGroupTouched(this.loginForm);return}this.isLoading=!0,this.errorMessage=null;let n={username:this.loginForm.value.username,password:this.loginForm.value.password};this.authService.login(n).subscribe({next:e=>{if(console.log("\u2705 Login successful:",e.user),this.isLoading=!1,this.returnUrl){this.router.navigateByUrl(this.returnUrl);return}let t=(e?.user?.role??"").toLowerCase();t==="admin"||t==="administrator"?this.router.navigate(["/admin"]):this.router.navigate(["/dashboard"])},error:e=>{console.error("\u274C Login failed:",e),this.isLoading=!1,this.errorMessage=e?.message||"Invalid username or password"}})}quickLogin(n,e){this.loginForm.patchValue({username:n,password:e}),this.onSubmit()}togglePasswordVisibility(){this.showPassword=!this.showPassword}markFormGroupTouched(n){Object.keys(n.controls).forEach(e=>{n.get(e)?.markAsTouched()})}get username(){return this.loginForm.get("username")}get password(){return this.loginForm.get("password")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=w({type:i,selectors:[["app-login"]],decls:42,vars:19,consts:[[1,"login-container"],[1,"login-card"],[1,"login-header","text-center","mb-4"],[1,"bi","bi-hospital","display-1","text-primary"],[1,"mt-3"],[1,"text-muted"],["class","alert alert-danger alert-dismissible fade show","role","alert",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","username",1,"form-label"],[1,"bi","bi-person"],["type","text","id","username","formControlName","username","placeholder","Enter username",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","password",1,"form-label"],[1,"bi","bi-lock"],[1,"input-group"],["id","password","formControlName","password","placeholder","Enter password",1,"form-control",3,"type","ngClass"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"bi",3,"ngClass"],["class","invalid-feedback","style","display: block",4,"ngIf"],[1,"mb-3","form-check"],["type","checkbox","id","rememberMe","formControlName","rememberMe",1,"form-check-input"],["for","rememberMe",1,"form-check-label"],["type","submit",1,"btn","btn-primary","w-100","mb-3",3,"disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","bi bi-box-arrow-in-right me-2",4,"ngIf"],[1,"demo-credentials","mt-4"],[1,"text-center","text-muted","mb-3"],[1,"bi","bi-info-circle"],[1,"row","g-2"],["class","col-12",4,"ngFor","ngForOf"],[1,"text-center","mt-4"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"bi","bi-exclamation-triangle-fill","me-2"],["type","button",1,"btn-close",3,"click"],[1,"invalid-feedback"],[4,"ngIf"],[1,"invalid-feedback",2,"display","block"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"bi","bi-box-arrow-in-right","me-2"],[1,"col-12"],[1,"card","bg-light"],[1,"card-body","py-2"],[1,"d-flex","justify-content-between","align-items-center"],[1,"d-block"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click","disabled"],[1,"bi","bi-arrow-right-circle"]],template:function(e,t){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2),m(3,"i",3),o(4,"h2",4),a(5,"Patient Management System"),r(),o(6,"p",5),a(7,"Please sign in to continue"),r()(),u(8,bi,4,1,"div",6),o(9,"form",7),g("ngSubmit",function(){return t.onSubmit()}),o(10,"div",8)(11,"label",9),m(12,"i",10),a(13," Username "),r(),m(14,"input",11),u(15,yi,3,2,"div",12),r(),o(16,"div",8)(17,"label",13),m(18,"i",14),a(19," Password "),r(),o(20,"div",15),m(21,"input",16),o(22,"button",17),g("click",function(){return t.togglePasswordVisibility()}),m(23,"i",18),r()(),u(24,Ei,3,2,"div",19),r(),o(25,"div",20),m(26,"input",21),o(27,"label",22),a(28," Remember me "),r()(),o(29,"button",23),u(30,wi,1,0,"span",24)(31,Ii,1,0,"i",25),a(32),r()(),o(33,"div",26)(34,"h6",27),m(35,"i",28),a(36," Demo Credentials "),r(),o(37,"div",29),u(38,Fi,13,4,"div",30),r()(),o(39,"div",31)(40,"small",5),a(41," \xA9 2025 Hospital Management System. Phase 3 Demo. "),r()()()()),e&2&&(l(8),s("ngIf",t.errorMessage),l(),s("formGroup",t.loginForm),l(5),S("is-invalid",(t.username==null?null:t.username.invalid)&&(t.username==null?null:t.username.touched))("is-valid",(t.username==null?null:t.username.valid)&&(t.username==null?null:t.username.touched)),l(),s("ngIf",(t.username==null?null:t.username.invalid)&&(t.username==null?null:t.username.touched)),l(6),s("type",t.showPassword?"text":"password")("ngClass",_t(16,_i,(t.password==null?null:t.password.invalid)&&(t.password==null?null:t.password.touched),(t.password==null?null:t.password.valid)&&(t.password==null?null:t.password.touched))),l(2),s("ngClass",t.showPassword?"bi-eye-slash":"bi-eye"),l(),s("ngIf",(t.password==null?null:t.password.invalid)&&(t.password==null?null:t.password.touched)),l(5),s("disabled",t.isLoading),l(),s("ngIf",t.isLoading),l(),s("ngIf",!t.isLoading),l(),h(" ",t.isLoading?"Signing in...":"Sign In"," "),l(6),s("ngForOf",t.demoCredentials))},dependencies:[T,Y,M,A,Ue,J,U,It,$,Z,Re,De],styles:[".login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2);padding:20px}.login-card[_ngcontent-%COMP%]{background:#fff;border-radius:15px;box-shadow:0 10px 40px #0003;padding:40px;width:100%;max-width:450px;animation:_ngcontent-%COMP%_slideUp .5s ease-out}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.login-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#667eea}.login-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#333;font-weight:600}.form-control[_ngcontent-%COMP%]:focus{border-color:#667eea;box-shadow:0 0 0 .2rem #667eea40}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border:none;padding:12px;font-weight:500;transition:transform .2s}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 5px 15px #667eea66}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.demo-credentials[_ngcontent-%COMP%]{border-top:1px solid #dee2e6;padding-top:20px}.demo-credentials[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{transition:transform .2s}.demo-credentials[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{transform:translate(5px)}.input-group[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%]{border-color:#ced4da}.input-group[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;border-color:#ced4da}@media(max-width:576px){.login-card[_ngcontent-%COMP%]{padding:30px 20px}}"]})};function Ai(i,n){if(i&1&&(o(0,"a",18),m(1,"i",19),a(2),r()),i&2){let e=p().$implicit;s("routerLink",e.path),l(),s("ngClass",e.icon),l(),h(" ",e.label," ")}}function Ti(i,n){if(i&1&&(ut(0),u(1,Ai,3,3,"a",17),gt()),i&2){let e=n.$implicit,t=p();l(),s("ngIf",t.canAccessRoute(e.roles))}}var He=class i{constructor(n,e){this.authService=n;this.router=e}currentUser=null;destroy$=new H;menuItems=[{path:"/dashboard/patients",icon:"bi-people",label:"Patients",roles:["admin","doctor","nurse"]},{path:"/dashboard/appointments",icon:"bi-calendar-check",label:"Appointments",roles:["admin","doctor","nurse"]},{path:"/admin",icon:"bi-gear",label:"Admin Panel",roles:["admin"]}];ngOnInit(){this.authService.currentUser$.pipe(O(this.destroy$)).subscribe(n=>{this.currentUser=n})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}logout(){this.authService.logout(),this.router.navigate(["/login"])}canAccessRoute(n){return this.authService.hasAnyRole(n)}getRoleBadgeClass(){switch(this.currentUser?.role){case"admin":return"bg-danger";case"doctor":return"bg-primary";case"nurse":return"bg-success";default:return"bg-secondary"}}static \u0275fac=function(e){return new(e||i)(y(V),y(L))};static \u0275cmp=w({type:i,selectors:[["app-dashboard"]],decls:25,vars:6,consts:[[1,"dashboard-container"],[1,"navbar","navbar-expand-lg","navbar-dark","bg-primary"],[1,"container-fluid"],["href","#",1,"navbar-brand"],[1,"bi","bi-hospital"],[1,"ms-auto","d-flex","align-items-center"],[1,"text-white","me-3"],[1,"bi","bi-person-circle","me-2"],[1,"badge","ms-2",3,"ngClass"],[1,"btn","btn-outline-light",3,"click"],[1,"bi","bi-box-arrow-right"],[1,"dashboard-content"],[1,"sidebar"],[1,"sidebar-menu"],[1,"sidebar-heading"],[4,"ngFor","ngForOf"],[1,"main-content"],["routerLinkActive","active","class","sidebar-item",3,"routerLink",4,"ngIf"],["routerLinkActive","active",1,"sidebar-item",3,"routerLink"],[1,"bi",3,"ngClass"]],template:function(e,t){e&1&&(o(0,"div",0)(1,"nav",1)(2,"div",2)(3,"a",3),m(4,"i",4),a(5," Patient Management System "),r(),o(6,"div",5)(7,"div",6),m(8,"i",7),o(9,"strong"),a(10),r(),o(11,"span",8),a(12),F(13,"uppercase"),r()(),o(14,"button",9),g("click",function(){return t.logout()}),m(15,"i",10),a(16," Logout "),r()()()(),o(17,"div",11)(18,"div",12)(19,"div",13)(20,"h6",14),a(21,"NAVIGATION"),r(),u(22,Ti,2,1,"ng-container",15),r()(),o(23,"div",16),m(24,"router-outlet"),r()()()),e&2&&(l(10),x(t.currentUser==null?null:t.currentUser.fullName),l(),s("ngClass",t.getRoleBadgeClass()),l(),h(" ",G(13,4,t.currentUser==null?null:t.currentUser.role)," "),l(10),s("ngForOf",t.menuItems))},dependencies:[T,Y,M,A,Oe,Ve,yt],styles:[".dashboard-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column}.navbar[_ngcontent-%COMP%]{box-shadow:0 2px 4px #0000001a}.dashboard-content[_ngcontent-%COMP%]{flex:1;display:flex}.sidebar[_ngcontent-%COMP%]{width:250px;background:#f8f9fa;border-right:1px solid #dee2e6;padding:20px 0}.sidebar-heading[_ngcontent-%COMP%]{padding:0 20px;color:#6c757d;font-size:.75rem;font-weight:600;letter-spacing:.5px;margin-bottom:10px}.sidebar-item[_ngcontent-%COMP%]{display:block;padding:12px 20px;color:#495057;text-decoration:none;transition:all .3s}.sidebar-item[_ngcontent-%COMP%]:hover{background:#e9ecef;color:#0d6efd;border-left:3px solid #0d6efd;padding-left:17px}.sidebar-item.active[_ngcontent-%COMP%]{background:#0d6efd;color:#fff;border-left:3px solid #0a58ca;padding-left:17px}.sidebar-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px;width:20px}.main-content[_ngcontent-%COMP%]{flex:1;padding:30px;background:#f8f9fa;overflow-y:auto}@media(max-width:768px){.sidebar[_ngcontent-%COMP%]{width:200px}.main-content[_ngcontent-%COMP%]{padding:15px}}"]})};var ie=class i{transform(n){switch(n.toLowerCase()){case"active":return"\u2713 Active";case"inactive":return"\u25CB Inactive";case"critical":return"\u26A0 Critical";default:return n}}static \u0275fac=function(e){return new(e||i)};static \u0275pipe=Me({name:"patientStatus",type:i,pure:!0})};var ne=class i{transform(n,e){if(!n)return 0;let t=new Date,d=new Date(n),c=t.getFullYear()-d.getFullYear();if(e){let b=t.getMonth()-d.getMonth();(b<0||b===0&&t.getDate()<d.getDate())&&c--}return c}static \u0275fac=function(e){return new(e||i)};static \u0275pipe=Me({name:"ageCalculator",type:i,pure:!0})};var Li=i=>["../edit-patient",i];function ki(i,n){if(i&1&&(o(0,"li",44),m(1,"i",45),a(2),r()),i&2){let e=n.$implicit;l(2),h(" ",e," ")}}function Oi(i,n){if(i&1&&(o(0,"div")(1,"ul",42),u(2,ki,3,1,"li",43),r()()),i&2){let e=p();l(2),s("ngForOf",e.patient.allergies)}}function Vi(i,n){i&1&&(o(0,"p",46),m(1,"i",47),a(2," No known allergies "),r())}function Ni(i,n){if(i&1&&(o(0,"li",44)(1,"strong"),a(2),r(),a(3),r()),i&2){let e=n.$implicit,t=n.index;l(2),h("",t+1,"."),l(),h(" ",e," ")}}function Di(i,n){if(i&1&&(o(0,"div")(1,"ul",42),u(2,Ni,4,2,"li",43),r()()),i&2){let e=p();l(2),s("ngForOf",e.patient.currentMedications)}}function Ri(i,n){i&1&&(o(0,"p",46),m(1,"i",47),a(2," No current medications "),r())}var re=class i{patient;closeDetail=new N;constructor(){console.log("PatientDetailComponent: Constructor called")}ngOnInit(){console.log("PatientDetailComponent: ngOnInit - Patient loaded:",this.patient)}ngOnChanges(n){n.patient&&console.log("PatientDetailComponent: Patient changed from",n.patient.previousValue,"to",n.patient.currentValue)}onClose(){console.log("PatientDetailComponent: Closing detail view"),this.closeDetail.emit()}getStatusBadgeClass(n){switch(n){case"active":return"bg-success";case"inactive":return"bg-secondary";case"critical":return"bg-danger";default:return"bg-primary"}}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=w({type:i,selectors:[["app-patient-detail"]],inputs:{patient:"patient"},outputs:{closeDetail:"closeDetail"},features:[we],decls:133,vars:37,consts:[["noAllergies",""],["noMedications",""],[1,"card","shadow"],[1,"card-header","bg-primary","text-white","d-flex","justify-content-between","align-items-center"],[1,"mb-0"],[1,"bi","bi-person-badge"],[1,"btn","btn-light","btn-sm",3,"click"],[1,"bi","bi-x-lg"],[1,"card-body"],[1,"row","mb-4"],[1,"col-md-8"],[1,"mb-3"],[1,"mb-2"],[1,"badge","fs-6",3,"ngClass"],[1,"col-md-4","text-end"],[1,"alert","alert-info","mb-0"],[1,"h4"],[1,"row"],[1,"col-md-6","mb-4"],[1,"card","bg-light"],[1,"card-header"],[1,"bi","bi-person-circle"],[1,"table","table-sm","table-borderless","mb-0"],["width","40%"],[1,"badge","bg-danger"],[1,"bi","bi-geo-alt"],[3,"href"],[1,"col-12","mb-4"],[1,"bi","bi-clipboard2-pulse"],[1,"card-header","bg-warning","text-dark"],[1,"bi","bi-exclamation-triangle"],[4,"ngIf","ngIfElse"],[1,"card-header","bg-info","text-white"],[1,"bi","bi-capsule"],[1,"col-12"],[1,"d-flex","justify-content-end","gap-2"],[1,"btn","btn-outline-primary",3,"routerLink"],[1,"bi","bi-pencil"],[1,"btn","btn-outline-success"],[1,"bi","bi-printer"],[1,"btn","btn-secondary",3,"click"],[1,"bi","bi-arrow-left"],[1,"list-group","list-group-flush"],["class","list-group-item bg-transparent",4,"ngFor","ngForOf"],[1,"list-group-item","bg-transparent"],[1,"bi","bi-dot","text-danger"],[1,"text-muted","mb-0"],[1,"bi","bi-check-circle","text-success"]],template:function(e,t){if(e&1){let d=P();o(0,"div",2)(1,"div",3)(2,"h3",4),m(3,"i",5),a(4," Patient Details"),r(),o(5,"button",6),g("click",function(){return v(d),f(t.onClose())}),m(6,"i",7),a(7," Close "),r()(),o(8,"div",8)(9,"div",9)(10,"div",10)(11,"h2",11),a(12),r(),o(13,"div",12)(14,"span",13),a(15),F(16,"patientStatus"),r()()(),o(17,"div",14)(18,"div",15)(19,"strong"),a(20,"Patient ID:"),r(),m(21,"br"),o(22,"span",16),a(23),r()()()()(),o(24,"div",17)(25,"div",18)(26,"div",19)(27,"div",20)(28,"h5",4),m(29,"i",21),a(30," Personal Information"),r()(),o(31,"div",8)(32,"table",22)(33,"tbody")(34,"tr")(35,"th",23),a(36,"Age:"),r(),o(37,"td"),a(38),F(39,"ageCalculator"),r()(),o(40,"tr")(41,"th"),a(42,"Date of Birth:"),r(),o(43,"td"),a(44),F(45,"date"),r()(),o(46,"tr")(47,"th"),a(48,"Gender:"),r(),o(49,"td"),a(50),r()(),o(51,"tr")(52,"th"),a(53,"Blood Group:"),r(),o(54,"td")(55,"span",24),a(56),r()()()()()()()(),o(57,"div",18)(58,"div",19)(59,"div",20)(60,"h5",4),m(61,"i",25),a(62," Contact Information"),r()(),o(63,"div",8)(64,"table",22)(65,"tbody")(66,"tr")(67,"th",23),a(68,"Email:"),r(),o(69,"td")(70,"a",26),a(71),F(72,"lowercase"),r()()(),o(73,"tr")(74,"th"),a(75,"Phone:"),r(),o(76,"td")(77,"a",26),a(78),r()()(),o(79,"tr")(80,"th"),a(81,"Address:"),r(),o(82,"td"),a(83),r()(),o(84,"tr")(85,"th"),a(86,"Last Visit:"),r(),o(87,"td"),a(88),F(89,"date"),r()()()()()()()(),o(90,"div",17)(91,"div",27)(92,"div",19)(93,"div",20)(94,"h5",4),m(95,"i",28),a(96," Medical History"),r()(),o(97,"div",8)(98,"p",4),a(99),r()()()()(),o(100,"div",17)(101,"div",18)(102,"div",19)(103,"div",29)(104,"h5",4),m(105,"i",30),a(106," Allergies"),r()(),o(107,"div",8),u(108,Oi,3,1,"div",31)(109,Vi,3,0,"ng-template",null,0,ae),r()()(),o(111,"div",18)(112,"div",19)(113,"div",32)(114,"h5",4),m(115,"i",33),a(116," Current Medications"),r()(),o(117,"div",8),u(118,Di,3,1,"div",31)(119,Ri,3,0,"ng-template",null,1,ae),r()()()(),o(121,"div",17)(122,"div",34)(123,"div",35)(124,"button",36),m(125,"i",37),a(126),r(),o(127,"button",38),m(128,"i",39),a(129," Print Record"),r(),o(130,"button",40),g("click",function(){return v(d),f(t.onClose())}),m(131,"i",41),a(132," Back to List "),r()()()()()}if(e&2){let d=E(110),c=E(120);l(12),z(" ",t.patient.firstName," ",t.patient.lastName," "),l(2),s("ngClass",t.getStatusBadgeClass(t.patient.status)),l(),h(" ",G(16,22,t.patient.status)," "),l(8),h("#",t.patient.id),l(15),h("",W(39,24,t.patient.dateOfBirth,!0)," years"),l(6),x(W(45,27,t.patient.dateOfBirth,"fullDate")),l(6),x(t.patient.gender),l(6),x(t.patient.bloodGroup),l(14),s("href","mailto:"+t.patient.email,Je),l(),x(G(72,30,t.patient.email)),l(6),s("href","tel:"+t.patient.phone,Je),l(),x(t.patient.phone),l(5),x(t.patient.address),l(5),x(W(89,32,t.patient.lastVisit,"MMMM dd, yyyy")),l(11),x(t.patient.medicalHistory),l(9),s("ngIf",t.patient.allergies.length>0)("ngIfElse",d),l(10),s("ngIf",t.patient.currentMedications.length>0)("ngIfElse",c),l(6),s("routerLink",ht(35,Li,t.patient.id)),l(2),h(" Edit Patient, ",t.patient.id," ")}},dependencies:[T,Y,M,A,Ve,Te,Le,ie,ne],encapsulation:2})};var We=class i{constructor(n){this.el=n}appHighlight="yellow";defaultColor="transparent";onMouseEnter(){this.highlight(this.appHighlight)}onMouseLeave(){this.highlight(this.defaultColor)}highlight(n){this.el.nativeElement.style.backgroundColor=n,this.el.nativeElement.style.transition="background-color 0.3s ease"}static \u0275fac=function(e){return new(e||i)(y(Ie))};static \u0275dir=Fe({type:i,selectors:[["","appHighlight",""]],hostBindings:function(e,t){e&1&&g("mouseenter",function(){return t.onMouseEnter()})("mouseleave",function(){return t.onMouseLeave()})},inputs:{appHighlight:"appHighlight",defaultColor:"defaultColor"}})};var ze=class i{constructor(n,e){this.el=n;this.renderer=e}appTooltip="";tooltipElement=null;onMouseEnter(){this.tooltipElement||this.showTooltip()}onMouseLeave(){this.tooltipElement&&this.hideTooltip()}showTooltip(){this.tooltipElement=this.renderer.createElement("span"),this.renderer.appendChild(this.tooltipElement,this.renderer.createText(this.appTooltip)),this.renderer.appendChild(this.el.nativeElement,this.tooltipElement),this.renderer.setStyle(this.tooltipElement,"background-color","#333"),this.renderer.setStyle(this.tooltipElement,"color","#fff"),this.renderer.setStyle(this.tooltipElement,"padding","5px 10px"),this.renderer.setStyle(this.tooltipElement,"border-radius","4px"),this.renderer.setStyle(this.tooltipElement,"font-size","12px"),this.renderer.setStyle(this.tooltipElement,"z-index","1000"),this.renderer.setStyle(this.tooltipElement,"white-space","nowrap");let n=this.el.nativeElement.getBoundingClientRect(),e=this.tooltipElement.getBoundingClientRect(),t=n.top-e.height-5,d=n.left+(n.width-e.width)/2;this.renderer.setStyle(this.tooltipElement,"top",`${t}px`),this.renderer.setStyle(this.tooltipElement,"left",`${d}px`),this.renderer.setStyle(this.el.nativeElement,"position","relative")}hideTooltip(){this.tooltipElement&&(this.renderer.removeChild(document.body,this.tooltipElement),this.tooltipElement=null)}static \u0275fac=function(e){return new(e||i)(y(Ie),y(pt))};static \u0275dir=Fe({type:i,selectors:[["","appTooltip",""]],hostBindings:function(e,t){e&1&&g("mouseenter",function(){return t.onMouseEnter()})("mouseleave",function(){return t.onMouseLeave()})},inputs:{appTooltip:"appTooltip"}})};function Bi(i,n){i&1&&(o(0,"div",15)(1,"div",16)(2,"span",17),a(3,"Loading..."),r()(),o(4,"p",18),a(5,"Loading patient details..."),r()())}function qi(i,n){if(i&1){let e=P();o(0,"div",19),m(1,"i",20),a(2),o(3,"button",21),g("click",function(){v(e);let d=p();return f(d.error=null)}),r()()}if(i&2){let e=p();l(2),h(" ",e.error," ")}}function Gi(i,n){if(i&1){let e=P();o(0,"div",22),m(1,"i",23),a(2),o(3,"button",21),g("click",function(){v(e);let d=p();return f(d.successMessage=null)}),r()()}if(i&2){let e=p();l(2),h(" ",e.successMessage," ")}}function Ui(i,n){if(i&1&&(o(0,"div",24)(1,"h6",25),a(2,"Read-Only Information"),r(),o(3,"div",26)(4,"div",27)(5,"strong"),a(6,"Name:"),r(),a(7),r(),o(8,"div",28)(9,"strong"),a(10,"DOB:"),r(),a(11),r(),o(12,"div",28)(13,"strong"),a(14,"Gender:"),r(),a(15),r(),o(16,"div",28)(17,"strong"),a(18,"Blood:"),r(),a(19),r(),o(20,"div",27)(21,"strong"),a(22,"Last Visit:"),r(),a(23),r()()()),i&2){let e=p();l(7),h(" ",e.originalPatient.name),l(4),h(" ",e.originalPatient.dateOfBirth),l(4),h(" ",e.originalPatient.gender),l(4),h(" ",e.originalPatient.bloodGroup),l(4),h(" ",e.originalPatient.lastVisit)}}function $i(i,n){i&1&&(o(0,"div"),a(1,"Email is required"),r())}function ji(i,n){i&1&&(o(0,"div"),a(1,"Please enter a valid email"),r())}function Hi(i,n){if(i&1&&(o(0,"div",56),u(1,$i,2,0,"div",57)(2,ji,2,0,"div",57),r()),i&2){p();let e=E(11);l(),s("ngIf",e.errors==null?null:e.errors.required),l(),s("ngIf",e.errors==null?null:e.errors.email)}}function Wi(i,n){i&1&&(o(0,"div"),a(1,"Phone is required"),r())}function zi(i,n){i&1&&(o(0,"div"),a(1,"Phone must be 10 digits"),r())}function Yi(i,n){if(i&1&&(o(0,"div",56),u(1,Wi,2,0,"div",57)(2,zi,2,0,"div",57),r()),i&2){p();let e=E(19);l(),s("ngIf",e.errors==null?null:e.errors.required),l(),s("ngIf",e.errors==null?null:e.errors.pattern)}}function Zi(i,n){i&1&&(o(0,"div"),a(1,"Address is required"),r())}function Ji(i,n){i&1&&(o(0,"div"),a(1," Address must be at least 10 characters "),r())}function Ki(i,n){if(i&1&&(o(0,"div",56),u(1,Zi,2,0,"div",57)(2,Ji,2,0,"div",57),r()),i&2){p();let e=E(27);l(),s("ngIf",e.errors==null?null:e.errors.required),l(),s("ngIf",e.errors==null?null:e.errors.minlength)}}function Qi(i,n){if(i&1&&(o(0,"option",58),a(1),r()),i&2){let e=n.$implicit;s("value",e),l(),h(" ",e," ")}}function Xi(i,n){i&1&&(o(0,"div",56),a(1," Status is required "),r())}function en(i,n){i&1&&m(0,"span",59)}function tn(i,n){i&1&&m(0,"i",60)}function nn(i,n){if(i&1){let e=P();o(0,"form",29,0),g("ngSubmit",function(){v(e);let d=E(1),c=p();return f(c.onSubmit(d))}),o(2,"h5",30),a(3,"Editable Fields"),r(),o(4,"div",31)(5,"div",32)(6,"label",33),a(7," Email "),o(8,"span",34),a(9,"*"),r()(),o(10,"input",35,1),q("ngModelChange",function(d){v(e);let c=p();return B(c.editablePatient.email,d)||(c.editablePatient.email=d),f(d)}),r(),u(12,Hi,3,2,"div",36),r(),o(13,"div",32)(14,"label",37),a(15," Phone "),o(16,"span",34),a(17,"*"),r()(),o(18,"input",38,2),q("ngModelChange",function(d){v(e);let c=p();return B(c.editablePatient.phone,d)||(c.editablePatient.phone=d),f(d)}),r(),u(20,Yi,3,2,"div",36),r(),o(21,"div",39)(22,"label",40),a(23," Address "),o(24,"span",34),a(25,"*"),r()(),o(26,"textarea",41,3),q("ngModelChange",function(d){v(e);let c=p();return B(c.editablePatient.address,d)||(c.editablePatient.address=d),f(d)}),r(),u(28,Ki,3,2,"div",36),r(),o(29,"div",42)(30,"label",43),a(31," Status "),o(32,"span",34),a(33,"*"),r()(),o(34,"select",44,4),q("ngModelChange",function(d){v(e);let c=p();return B(c.editablePatient.status,d)||(c.editablePatient.status=d),f(d)}),o(36,"option",45),a(37,"Select Status"),r(),u(38,Qi,2,2,"option",46),r(),u(39,Xi,2,0,"div",36),r(),o(40,"div",32)(41,"label",47),a(42," Current Medication "),r(),o(43,"input",48),q("ngModelChange",function(d){v(e);let c=p();return B(c.editablePatient.currentMedication,d)||(c.editablePatient.currentMedication=d),f(d)}),r(),o(44,"small",49),a(45,"Optional field"),r()()(),o(46,"div",50)(47,"button",51),g("click",function(){v(e);let d=p();return f(d.onCancel())}),m(48,"i",52),a(49," Cancel "),r(),o(50,"button",53),u(51,en,1,0,"span",54)(52,tn,1,0,"i",55),a(53),r()()()}if(i&2){let e=E(1),t=E(11),d=E(19),c=E(27),b=E(35),C=p();l(10),S("is-invalid",t.invalid&&t.touched)("is-valid",t.valid&&t.touched),R("ngModel",C.editablePatient.email),l(2),s("ngIf",t.invalid&&t.touched),l(6),S("is-invalid",d.invalid&&d.touched)("is-valid",d.valid&&d.touched),R("ngModel",C.editablePatient.phone),l(2),s("ngIf",d.invalid&&d.touched),l(6),S("is-invalid",c.invalid&&c.touched)("is-valid",c.valid&&c.touched),R("ngModel",C.editablePatient.address),l(2),s("ngIf",c.invalid&&c.touched),l(6),S("is-invalid",b.invalid&&b.touched)("is-valid",b.valid&&b.touched),R("ngModel",C.editablePatient.status),l(4),s("ngForOf",C.statusOptions),l(),s("ngIf",b.invalid&&b.touched),l(4),R("ngModel",C.editablePatient.currentMedication),l(4),s("disabled",C.loading()),l(3),s("disabled",e.invalid||C.loading()||!C.hasChanges()),l(),s("ngIf",C.loading()),l(),s("ngIf",!C.loading()),l(),h(" ",C.loading()?"Updating...":"Update Patient"," ")}}var oe=class i{constructor(n,e,t,d){this.patientService=n;this.logger=e;this.activatedRoute=t;this.router=d}patientId;useRoutingCancel=!0;patientUpdated=new N;cancelled=new N;editablePatient={};originalPatient=null;loading=D(!1);error=null;successMessage=null;statusOptions=["Active","Inactive","Discharged","Critical"];ngOnInit(){this.patientId||this.activatedRoute.paramMap.subscribe(n=>{let e=n.get("id");if(e)this.patientId=e;else{console.log("PatientDetailComponent: ngOnInit - No id in route.");return}}),this.loadPatient()}loadPatient(){this.loading.set(!0),this.error=null,this.patientService.getPatientById(this.patientId).subscribe({next:n=>{this.originalPatient=n,this.editablePatient={id:n.id,email:n.email,phone:n.phone,address:n.address,status:n.status,currentMedication:n.currentMedication},this.logger.log(`Loaded patient ${n.name} for editing`),this.loading.set(!1)},error:n=>{this.error="Failed to load patient details",this.loading.set(!1),this.logger.error(`Error loading patient: ${n.message}`)}})}onSubmit(n){if(n.invalid){this.error="Please fix the validation errors before submitting";return}if(!this.originalPatient){this.error="Original patient data not available";return}this.loading.set(!0),this.error=null,this.successMessage=null;let e=new Date().toISOString().split("T")[0],t=tt(et({},this.originalPatient),{email:this.editablePatient.email,phone:this.editablePatient.phone,address:this.editablePatient.address,status:this.editablePatient.status,lastVisit:e,currentMedication:this.editablePatient.currentMedication});this.patientService.updatePatient(t.id,t).subscribe({next:d=>{this.successMessage="Patient updated successfully!",this.loading.set(!1),this.logger.log(`Patient ${d.name} updated successfully`),setTimeout(()=>{this.useRoutingCancel?this.router.navigate(["/patients"]):this.patientUpdated.emit(d)},1500)},error:d=>{this.error="Failed to update patient",this.loading.set(!1),this.logger.error(`Error updating patient: ${d.message}`)}})}onCancel(){this.logger.log("Edit patient cancelled"),this.useRoutingCancel?this.router.navigate(["/patients"]):this.cancelled.emit()}hasChanges(){return this.originalPatient?this.editablePatient.email!==this.originalPatient.email||this.editablePatient.phone!==this.originalPatient.phone||this.editablePatient.address!==this.originalPatient.address||this.editablePatient.status!==this.originalPatient.status||this.editablePatient.currentMedication!==this.originalPatient.currentMedication:!1}static \u0275fac=function(e){return new(e||i)(y(X),y(j),y(ke),y(L))};static \u0275cmp=w({type:i,selectors:[["app-edit-patient"]],inputs:{patientId:"patientId",useRoutingCancel:"useRoutingCancel"},outputs:{patientUpdated:"patientUpdated",cancelled:"cancelled"},features:[Ae([j])],decls:11,vars:5,consts:[["editForm","ngForm"],["emailField","ngModel"],["phoneField","ngModel"],["addressField","ngModel"],["statusField","ngModel"],[1,"container-fluid","p-4"],[1,"card"],[1,"card-header","bg-primary","text-white"],[1,"mb-0"],[1,"card-body"],["class","text-center py-4",4,"ngIf"],["class","alert alert-danger alert-dismissible fade show","role","alert",4,"ngIf"],["class","alert alert-success alert-dismissible fade show","role","alert",4,"ngIf"],["class","alert alert-secondary mb-4",4,"ngIf"],[3,"ngSubmit",4,"ngIf"],[1,"text-center","py-4"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"bi","bi-exclamation-triangle-fill","me-2"],["type","button",1,"btn-close",3,"click"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show"],[1,"bi","bi-check-circle-fill","me-2"],[1,"alert","alert-secondary","mb-4"],[1,"mb-2"],[1,"row"],[1,"col-md-3"],[1,"col-md-2"],[3,"ngSubmit"],[1,"border-bottom","pb-2","mb-3"],[1,"row","g-3"],[1,"col-md-6"],["for","email",1,"form-label"],[1,"text-danger"],["type","email","id","email","name","email","required","","email","",1,"form-control",3,"ngModelChange","ngModel"],["class","invalid-feedback",4,"ngIf"],["for","phone",1,"form-label"],["type","tel","id","phone","name","phone","required","","pattern","^[0-9]{10}$",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12"],["for","address",1,"form-label"],["id","address","name","address","rows","2","required","","minlength","10",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-4"],["for","status",1,"form-label"],["id","status","name","status","required","",1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","currentMedication",1,"form-label"],["type","text","id","currentMedication","name","currentMedication","placeholder","e.g., Aspirin, Insulin",1,"form-control",3,"ngModelChange","ngModel"],[1,"text-muted"],[1,"d-flex","gap-2","justify-content-end","mt-4"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],[1,"bi","bi-x-circle","me-1"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],["class","bi bi-check-circle me-1",4,"ngIf"],[1,"invalid-feedback"],[4,"ngIf"],[3,"value"],[1,"spinner-border","spinner-border-sm","me-1"],[1,"bi","bi-check-circle","me-1"]],template:function(e,t){e&1&&(o(0,"div",5)(1,"div",6)(2,"div",7)(3,"h4",8),a(4,"Edit Patient (Template-Driven Form)"),r()(),o(5,"div",9),u(6,Bi,6,0,"div",10)(7,qi,4,1,"div",11)(8,Gi,4,1,"div",12)(9,Ui,24,5,"div",13)(10,nn,54,31,"form",14),r()()()),e&2&&(l(6),s("ngIf",t.loading()),l(),s("ngIf",t.error),l(),s("ngIf",t.successMessage),l(),s("ngIf",t.originalPatient&&!t.loading()),l(),s("ngIf",!t.loading()))},dependencies:[T,M,A,Ge,J,K,Q,U,Be,$,Z,Lt,Ot,Vt,kt,Ne,Ft],encapsulation:2})};function rn(i,n){if(i&1){let e=P();o(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14)(4,"div",15)(5,"span",16),m(6,"i",17),r(),o(7,"input",18),q("ngModelChange",function(d){v(e);let c=p();return B(c.searchTerm,d)||(c.searchTerm=d),f(d)}),g("ngModelChange",function(){v(e);let d=p();return f(d.onSearchChange())}),r()()(),o(8,"div",19)(9,"div",15)(10,"label",20),a(11,"Status:"),r(),o(12,"select",21),g("change",function(d){v(e);let c=p();return f(c.onFilterChange(d))}),o(13,"option",22),a(14,"All Patients"),r(),o(15,"option",23),a(16,"Active"),r(),o(17,"option",24),a(18,"Inactive"),r(),o(19,"option",25),a(20,"Critical"),r()()()(),o(21,"div",26)(22,"button",27),g("click",function(){v(e);let d=p();return f(d.onRefreshPatients())}),m(23,"i",28),a(24," Refresh "),r(),o(25,"button",29),g("click",function(){v(e);let d=p();return f(d.onToggleAddForm())}),m(26,"i",30),a(27," Add Patient "),r()()()()()}if(i&2){let e=p();l(7),R("ngModel",e.searchTerm),s("disabled",e.isLoading()),l(5),s("value",e.filterStatus)("disabled",e.isLoading()),l(10),s("disabled",e.isLoading()),l(3),s("disabled",e.isLoading()&&e.selectedPatient)}}function on(i,n){if(i&1&&(o(0,"div",31)(1,"div",14)(2,"div",32)(3,"div",12)(4,"h6",33),a(5,"Total Patients"),r(),o(6,"h2",34),a(7),r()()()(),o(8,"div",14)(9,"div",32)(10,"div",12)(11,"h6",33),a(12,"Filtered Results"),r(),o(13,"h2",35),a(14),r()()()(),o(15,"div",14)(16,"div",32)(17,"div",12)(18,"h6",33),a(19,"Search Term"),r(),o(20,"h2",36),a(21),r()()()()()),i&2){let e=p();l(7),x(e.totalPatients),l(7),x(e.filteredPatients.length),l(7),x(e.searchTerm||"None")}}function an(i,n){i&1&&(o(0,"div",37)(1,"div",38)(2,"span",39),a(3,"Loading..."),r()(),o(4,"p",40),a(5,"Loading patients..."),r()())}function ln(i,n){if(i&1&&(o(0,"div",48)(1,"strong",49),a(2,"Allergies:"),r(),o(3,"span",61),a(4),r()()),i&2){let e=p().$implicit;l(4),h("",e.allergies.length," allergy(ies)")}}function dn(i,n){if(i&1&&(o(0,"span",50),a(1),r()),i&2){let e=p().$implicit;l(),h(" ",e.currentMedications.length," medication(s) ")}}function sn(i,n){i&1&&(o(0,"span",62),a(1,"None"),r())}function mn(i,n){if(i&1){let e=P();o(0,"div",44)(1,"div",45),g("click",function(){let d=v(e).$implicit,c=p(2);return f(c.onViewPatient(d))}),o(2,"div",46)(3,"h5",47),a(4),r(),o(5,"span"),a(6),F(7,"patientStatus"),r()(),o(8,"div",12)(9,"div",48)(10,"strong",49),a(11,"Age:"),r(),o(12,"span",50),a(13),F(14,"ageCalculator"),r()(),o(15,"div",48)(16,"strong",49),a(17,"Blood Group:"),r(),o(18,"span",50),a(19),r()(),o(20,"div",48)(21,"strong",49),a(22,"Last Visit:"),r(),o(23,"span",50),a(24),F(25,"date"),r()(),o(26,"div",48)(27,"strong",49),a(28,"Email:"),r(),o(29,"span",51),a(30),F(31,"lowercase"),r()(),u(32,ln,5,1,"div",52),o(33,"div",48)(34,"strong",49),a(35,"Medications:"),r(),u(36,dn,2,1,"span",53)(37,sn,2,0,"ng-template",null,0,ae),r()(),o(39,"div",54),g("click",function(d){return v(e),f(d.stopPropagation())}),o(40,"button",55),g("click",function(){let d=v(e).$implicit,c=p(2);return f(c.onEditPatient(d))}),m(41,"i",56),a(42," Edit "),r(),o(43,"button",57),g("click",function(){let d=v(e).$implicit,c=p(2);return f(c.onDeletePatient(d))}),m(44,"i",58),a(45," Delete "),r(),o(46,"button",59),g("click",function(){let d=v(e).$implicit,c=p(2);return f(c.onViewPatient(d))}),m(47,"i",60),a(48," View Details "),o(49,"small",49),a(50),r()()()()()}if(i&2){let e=n.$implicit,t=E(38),d=p(2);l(),vt("transform","scale(1)"),s("appHighlight",e.status.toLowerCase()==="critical"?"#ffe6e6":"#e6f3ff")("defaultColor","white")("appTooltip","Click to view details for "+e.firstName+" "+e.lastName),l(3),z(" ",e.firstName," ",e.lastName," "),l(),ft("badge "+d.getStatusBadgeClass(e.status)),l(),h(" ",G(7,18,e.status)," "),l(7),h("",W(14,20,e.dateOfBirth,!0)," years"),l(6),x(e.bloodGroup),l(5),x(W(25,23,e.lastVisit,"MMM dd, yyyy")),l(6),x(G(31,26,e.email)),l(2),s("ngIf",e.allergies.length>0),l(4),s("ngIf",e.currentMedications.length>0)("ngIfElse",t),l(14),h("#",e.id)}}function cn(i,n){if(i&1){let e=P();o(0,"div",37)(1,"div",63),m(2,"i",64),o(3,"strong"),a(4,"No patients found matching your criteria."),r()(),o(5,"div",65)(6,"button",66),g("click",function(){v(e);let d=p(2);return d.searchTerm="",d.filterStatus="all",f(d.filterPatients())}),m(7,"i",67),a(8," Clear Filters "),r()()()}}function pn(i,n){i&1&&(o(0,"p",74),m(1,"i",75),a(2," Showing only active patients "),r())}function un(i,n){i&1&&(o(0,"p",74),m(1,"i",76),a(2," Showing only inactive patients "),r())}function gn(i,n){i&1&&(o(0,"p",74),m(1,"i",77),a(2," Showing only critical patients "),r())}function vn(i,n){i&1&&(o(0,"p",74),m(1,"i",78),a(2," Showing all patients regardless of status "),r())}function fn(i,n){if(i&1&&(o(0,"div",68)(1,"h5",69),m(2,"i",70),a(3," Patient Status Legend:"),r(),o(4,"div",71),u(5,pn,3,0,"p",72)(6,un,3,0,"p",72)(7,gn,3,0,"p",72)(8,vn,3,0,"p",73),r()()),i&2){let e=p(2);l(4),s("ngSwitch",e.filterStatus),l(),s("ngSwitchCase","active"),l(),s("ngSwitchCase","inactive"),l(),s("ngSwitchCase","critical")}}function hn(i,n){if(i&1&&(o(0,"div")(1,"div",41),u(2,mn,51,28,"div",42)(3,cn,9,0,"div",8),r(),u(4,fn,9,4,"div",43),r()),i&2){let e=p();l(2),s("ngForOf",e.filteredPatients)("ngForTrackBy",e.trackByPatientId),l(),s("ngIf",e.filteredPatients.length===0),l(),s("ngIf",!e.isLoading()&&!e.selectedPatient&&!e.showAddForm&&!e.showEditForm)}}function _n(i,n){if(i&1){let e=P();o(0,"div")(1,"app-patient-detail",79),g("closeDetail",function(){v(e);let d=p();return f(d.onCloseDetail())}),r()()}if(i&2){let e=p();l(),s("patient",e.selectedPatient)}}function bn(i,n){if(i&1){let e=P();o(0,"div",80)(1,"app-add-patient",81),g("patientAdded",function(){v(e);let d=p();return f(d.onPatientAdded())})("cancelled",function(){v(e);let d=p();return f(d.onCancelAddForm())}),r()()}}function xn(i,n){if(i&1){let e=P();o(0,"div",80)(1,"app-edit-patient",82),g("patientUpdated",function(d){v(e);let c=p();return f(c.onPatientUpdated(d))})("cancelled",function(){v(e);let d=p();return f(d.onCancelEditForm())}),r()()}if(i&2){let e=p();l(),s("patientId",e.editingPatientId||1)("useRoutingCancel",!1)}}var Ye=class i{constructor(n){this.patientService=n;console.log("Constructor: Component instance created"),this.lifecycleLog.push("Constructor called")}patients=[];filteredPatients=[];selectedPatient=null;searchTerm="";filterStatus="all";showAddForm=!1;showEditForm=!1;showPatientDetails=!1;editingPatientId="";isLoading=D(!1);componentTitle="Patient Management System";totalPatients=0;errorMessage=null;lifecycleLog=[];destroy$=new H;searchSubject=new H;ngOnInit(){console.log("ngOnInit: Component initialized"),this.lifecycleLog.push("ngOnInit called"),this.setupSearchSubscription(),this.loadPatients()}ngDoCheck(){}ngAfterViewInit(){console.log("ngAfterViewInit: View initialized"),this.lifecycleLog.push("ngAfterViewInit called")}ngOnDestroy(){console.log("ngOnDestroy: Component destroyed"),this.lifecycleLog.push("ngOnDestroy called"),this.destroy$.next(),this.destroy$.complete()}setupSearchSubscription(){this.searchSubject.pipe(ot(300),dt(),O(this.destroy$)).subscribe(()=>{this.filterPatients()})}loadPatients(){this.isLoading.set(!0),this.errorMessage=null,this.patientService.getAllPatients().pipe(O(this.destroy$)).subscribe({next:n=>{this.patients=n,this.totalPatients=n.length,this.filterPatients(),this.isLoading.set(!1),console.log("Patients loaded:",n.length)},error:n=>{this.errorMessage=n.message,this.isLoading.set(!1)}})}onSearchChange(){this.searchSubject.next(this.searchTerm)}onFilterChange(n){let e=n.target;this.filterStatus=e.value.toLowerCase(),this.filterPatients()}onCloseDetail(){console.log("Closing patient detail view"),this.selectedPatient=null,this.showPatientDetails=!1}onToggleAddForm(){this.showAddForm=!this.showAddForm,console.log("Add form toggled:",this.showAddForm)}onPatientAdded(){this.showAddForm=!1,this.loadPatients()}onCancelAddForm(){this.showAddForm=!1}onEditPatient(n){this.showEditForm=!0,this.editingPatientId=n.id,this.showAddForm=!1}onPatientUpdated(n){this.showEditForm=!1,this.editingPatientId=null,this.loadPatients()}onCancelEditForm(){this.showEditForm=!1,this.editingPatientId=null}onRefreshPatients(){console.log("Refreshing patient list"),this.filterStatus="all",this.searchTerm="",this.loadPatients()}clearError(){this.errorMessage=null}onDeletePatient(n){confirm(`Are you sure you want to delete ${n.firstName} ${n.lastName}?`)&&this.patientService.deletePatient(n.id).pipe(O(this.destroy$)).subscribe({next:()=>{this.selectedPatient?.id===n.id&&(this.selectedPatient=null),this.loadPatients()},error:e=>{this.errorMessage=e.message}})}filterPatients(){let n=this.searchTerm.trim().toLowerCase();this.filteredPatients=this.patients.filter(e=>{let t=n===""||e.firstName?.toLowerCase().includes(n)||e.lastName?.toLowerCase().includes(n)||e.email?.toLowerCase().includes(n),d=this.filterStatus.toLowerCase()==="all"||e.status.toLowerCase()===this.filterStatus;return t&&d})}getStatusClass(n){return`status-badge status-${n.toLowerCase()}`}getStatusBadgeClass(n){switch(n.toLowerCase()){case"active":return"bg-success";case"inactive":return"bg-secondary";case"critical":return"bg-danger";default:return"bg-primary"}}trackByPatientId(n,e){return e.id}onViewPatient(n){console.log("Patient selected:",n?.firstName,n?.lastName),this.selectedPatient=n,this.showPatientDetails=!0}static \u0275fac=function(e){return new(e||i)(y(X))};static \u0275cmp=w({type:i,selectors:[["app-patient-list"]],decls:14,vars:8,consts:[["noMeds",""],[1,"container-fluid","py-4"],[1,"text-center","mb-4"],[1,"bg-gradient","text-white","p-4","rounded","shadow"],[1,"display-4","mb-2"],[1,"lead","mb-0"],["class","card shadow-sm mb-4",4,"ngIf"],["class","row g-3 mb-4",4,"ngIf"],["class","text-center py-5",4,"ngIf"],[4,"ngIf"],["class","mb-4",4,"ngIf"],[1,"card","shadow-sm","mb-4"],[1,"card-body"],[1,"row","g-3","align-items-center"],[1,"col-md-4"],[1,"input-group"],[1,"input-group-text"],[1,"bi","bi-search"],["type","text","placeholder","Search by name or email...",1,"form-control",3,"ngModelChange","ngModel","disabled"],[1,"col-md-3"],["for","statusFilter",1,"input-group-text"],["id","statusFilter",1,"form-select",3,"change","value","disabled"],["value","all"],["value","active"],["value","inactive"],["value","critical"],[1,"col-md-5","text-end"],[1,"btn","btn-success","me-2",3,"click","disabled"],[1,"bi","bi-arrow-clockwise"],[1,"btn","btn-primary",3,"click","disabled"],[1,"bi","bi-plus-circle"],[1,"row","g-3","mb-4"],[1,"card","text-center","shadow-sm"],[1,"card-subtitle","mb-2","text-muted"],[1,"card-title","text-primary","mb-0"],[1,"card-title","text-success","mb-0"],[1,"card-title","text-info","mb-0"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary",2,"width","3rem","height","3rem"],[1,"visually-hidden"],[1,"mt-3","text-muted"],[1,"row","g-4"],["class","col-lg-4 col-md-6",4,"ngFor","ngForOf","ngForTrackBy"],["class","alert alert-light mt-4",4,"ngIf"],[1,"col-lg-4","col-md-6"],[1,"card","h-100","shadow-sm",2,"cursor","pointer","transition","transform 0.2s",3,"click","appHighlight","defaultColor","appTooltip"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"card-title","mb-0"],[1,"mb-2"],[1,"text-muted"],[1,"float-end"],[1,"float-end","text-break"],["class","mb-2",4,"ngIf"],["class","float-end",4,"ngIf","ngIfElse"],[1,"card-footer","bg-transparent","d-flex","justify-content-end","gap-2",3,"click"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"bi","bi-pencil"],["type","button",1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"bi","bi-trash"],["type","button",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"bi","bi-arrow-right"],[1,"float-end","text-danger","fw-bold"],[1,"float-end","text-muted"],[1,"alert","alert-info","d-inline-block"],[1,"bi","bi-info-circle","me-2"],[1,"mt-3"],[1,"btn","btn-secondary",3,"click"],[1,"bi","bi-x-circle"],[1,"alert","alert-light","mt-4"],[1,"alert-heading"],[1,"bi","bi-info-circle"],[3,"ngSwitch"],["class","mb-0",4,"ngSwitchCase"],["class","mb-0",4,"ngSwitchDefault"],[1,"mb-0"],[1,"bi","bi-check-circle","text-success"],[1,"bi","bi-dash-circle","text-secondary"],[1,"bi","bi-exclamation-triangle","text-danger"],[1,"bi","bi-list-ul","text-primary"],[3,"closeDetail","patient"],[1,"mb-4"],[3,"patientAdded","cancelled"],[3,"patientUpdated","cancelled","patientId","useRoutingCancel"]],template:function(e,t){e&1&&(o(0,"div",1)(1,"header",2)(2,"div",3)(3,"h1",4),a(4),r(),o(5,"p",5),a(6,"Comprehensive Patient Records Management"),r()()(),u(7,rn,28,6,"div",6)(8,on,22,3,"div",7)(9,an,6,0,"div",8)(10,hn,5,4,"div",9)(11,_n,2,1,"div",9)(12,bn,2,0,"div",10)(13,xn,2,2,"div",10),r()),e&2&&(l(4),x(t.componentTitle),l(3),s("ngIf",!t.selectedPatient&&!t.showAddForm&&!t.showEditForm),l(),s("ngIf",!t.selectedPatient&&!t.showAddForm&&!t.showEditForm),l(),s("ngIf",t.isLoading()),l(),s("ngIf",!t.isLoading()&&!t.selectedPatient&&!t.showAddForm&&!t.showEditForm),l(),s("ngIf",t.showPatientDetails&&t.selectedPatient),l(),s("ngIf",t.showAddForm),l(),s("ngIf",t.showEditForm))},dependencies:[T,M,A,bt,xt,Ct,Ge,K,Q,U,$,Ne,re,We,ze,ee,oe,Te,Le,ie,ne],styles:[".bg-gradient[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)!important}.card[_ngcontent-%COMP%]{transition:all .3s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 .5rem 1rem #00000026!important}"]})};var Xe=(i,n)=>{let e=I(V),t=I(L);return console.log("\u{1F6E1}\uFE0F AuthGuard checking authentication for:",n.url),e.isLoggedIn()?(console.log("\u2705 User is authenticated"),!0):(console.log("\u274C User not authenticated, redirecting to login"),t.navigate(["/login"],{queryParams:{returnUrl:n.url}}),!1)},Dt=i=>(n,e)=>{let t=I(V),d=I(L);console.log("\u{1F6E1}\uFE0F RoleGuard checking roles for:",e.url),console.log("\u{1F511} Required roles:",i);let c=t.getUserRole();return console.log("\u{1F464} User role:",c),c&&i.includes(c)?(console.log("\u2705 User has required role"),!0):(console.log("\u274C User does not have required role"),d.navigate(["/unauthorized"]),!1)};var Rt=[{path:"",redirectTo:"/login",pathMatch:"full"},{path:"login",component:je},{path:"dashboard",component:He,canActivate:[Xe],children:[{path:"",redirectTo:"patients",pathMatch:"full"},{path:"patients",component:Ye,data:{title:"Patient Management"}},{path:"patient/:id",component:re},{path:"add-patient",component:ee},{path:"edit-patient/:id",component:oe},{path:"appointments",loadComponent:()=>import("./chunk-VT5XWIOM.js").then(i=>i.AppointmentsComponent),data:{title:"Appointment Scheduling"}}]},{path:"admin",canActivate:[Xe,Dt(["admin"])],loadComponent:()=>import("./chunk-Z2Q7J63P.js").then(i=>i.AdminComponent),data:{title:"Admin Panel"}},{path:"unauthorized",loadComponent:()=>import("./chunk-XTZGIFDQ.js").then(i=>i.UnauthorizedComponent)},{path:"**",redirectTo:"/login"}];var Bt=(i,n)=>{let e=I(V),t=I(L),d=e.getToken();console.log("\u{1F504} HTTP Interceptor:",i.method,i.url);let c=i;return d&&(c=i.clone({setHeaders:{Authorization:`Bearer ${d}`}}),console.log("\u{1F511} Token attached to request")),n(c).pipe(rt(b=>(b.status===401&&(console.error("\u274C 401 Unauthorized - Logging out"),e.logout(),t.navigate(["/login"])),b.status===403&&console.error("\u274C 403 Forbidden - Insufficient permissions"),it(()=>b))))};var qt={providers:[ct(),wt(Rt),St(Et([Bt]))]};var Ze=class i{title=D("Shubham");constructor(){console.log("constructor is called")}ngOnChanges(n){console.log("ngOnChanges is called {0}",n)}ngOnInit(){console.log("ngOnInit is called")}ngAfterViewInit(){console.log("ngAfterViewInit is called")}ngOnDestroy(){console.log("ngOnDestroy is called")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=w({type:i,selectors:[["app-root"]],features:[we],decls:1,vars:0,template:function(e,t){e&1&&m(0,"router-outlet")},dependencies:[Oe],encapsulation:2})};Pt(Ze,qt).catch(i=>console.error(i));
